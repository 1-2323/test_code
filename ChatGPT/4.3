from fastapi import FastAPI, HTTPException
from pydantic import BaseModel

app = FastAPI()

PASS_SCORE = 70


class TestSubmitRequest(BaseModel):
    user_id: int
    score: int


@app.post("/test/submit")
def submit_test(payload: TestSubmitRequest):
    if payload.score < 0:
        raise HTTPException(status_code=400, detail="Invalid score")

    if payload.score < PASS_SCORE:
        return {"status": "failed", "certificate": False}

    certificate_id = f"CERT-{payload.user_id}"

    return {
        "status": "passed",
        "certificate": True,
        "certificate_id": certificate_id,
    }
