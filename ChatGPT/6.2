import yaml
from pathlib import Path
from typing import Any


class YamlConfigLoader:
    """
    Loads YAML configuration and applies it to an application object.
    Configuration keys are mapped directly to object attributes.
    """

    def __init__(self, config_path: str | Path):
        self._path = Path(config_path)

    def load(self) -> dict[str, Any]:
        if not self._path.exists():
            raise FileNotFoundError(f"Config file not found: {self._path}")

        try:
            with self._path.open("r", encoding="utf-8") as f:
                data = yaml.safe_load(f) or {}
        except yaml.YAMLError as exc:
            raise ValueError("Invalid YAML configuration") from exc

        if not isinstance(data, dict):
            raise ValueError("Root of YAML config must be a mapping")

        return data

    def apply(self, app: Any) -> None:
        config = self.load()

        for key, value in config.items():
            if hasattr(app, key):
                setattr(app, key, value)
            else:
                raise AttributeError(
                    f"Application object has no attribute '{key}'"
                )
