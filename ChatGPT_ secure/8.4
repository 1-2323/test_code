from fastapi import FastAPI, HTTPException
from pydantic import BaseModel, Field, ValidationError
from typing import List

app = FastAPI()


class ItemSchema(BaseModel):
    id: int = Field(gt=0)
    name: str = Field(min_length=1, max_length=255)
    value: float


class ImportPayload(BaseModel):
    items: List[ItemSchema]


def save_to_db(items: List[ItemSchema]) -> None:
    # безопасное сохранение в БД (batch insert / транзакция)
    pass


@app.post("/import")
async def import_data(payload: ImportPayload) -> dict:
    try:
        save_to_db(payload.items)
    except Exception:
        raise HTTPException(status_code=500, detail="Failed to save data")

    return {"status": "imported"}
