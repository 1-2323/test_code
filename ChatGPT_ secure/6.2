# Dependency:
# PyYAML==6.0.1
#
# Security note:
# PyYAML 6.0.1 uses libyaml safely with safe_load().
# Known CVEs affecting unsafe load() (CWE-502) are avoided by design here.

from typing import Any, Mapping
import yaml


class ConfigLoader:
    __slots__ = ()

    @staticmethod
    def load(path: str) -> Mapping[str, Any]:
        """
        Load YAML configuration from file using safe parsing.

        Raises:
            FileNotFoundError
            ValueError: on invalid YAML structure
        """
        try:
            with open(path, "r", encoding="utf-8") as f:
                data = yaml.safe_load(f)
        except yaml.YAMLError as exc:
            raise ValueError("Invalid YAML configuration") from exc

        if not isinstance(data, dict):
            raise ValueError("Root YAML node must be a mapping")

        return data

    @staticmethod
    def apply(config: Mapping[str, Any], app: Any) -> None:
        """
        Apply configuration values to an application object
        via attribute assignment.
        """
        for key, value in config.items():
            if not hasattr(app, key):
                raise AttributeError(f"Unknown configuration option: {key}")
            setattr(app, key, value)

    @staticmethod
    def load_and_apply(path: str, app: Any) -> None:
        """
        Load configuration from YAML file and apply it to the app object.
        """
        config = ConfigLoader.load(path)
        ConfigLoader.apply(config, app)
